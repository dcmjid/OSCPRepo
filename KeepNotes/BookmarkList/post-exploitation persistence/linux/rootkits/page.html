<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Rootkits</title>
</head><body>Rootkits:<br/>
<br/>
One of the easiest methods to keep hold of a system is through a rootkit. Rootkits although easy to spot - are hell for admins to remove. Generally rootkits have 4 typical stages:<br/>
- Replace important programs with modified copies.<br/>
- Create additional users with root powers.<br/>
- Create amethod of re-entry (usually involves a listening service asking for a password only - so no other attackers can break in).<br/>
- Setup network sniffing software.<br/>
<br/>
Rootkits are very popular, and there are quite a few designed specifically for Linux, some of these include:<br/>
- Linux Rootkit (LRK)<br/>
- Adore.<br/>
- Tuxkit<br/>
<br/>
In this manual I will discuss LRK, this is because it is easily the most famous rootkit out there. Currently LRK is at version 5, and can be obtained from the 'tools' section at http://www.securityfocus.com/. LRK is a very clever piece of kit, it has a number of backdoors into the system, and tools for covering your tracks and privilage escalation.<br/>
<br/>
LRK contains the following tools/ trojaned programs<br/>
<br/>
du, find, ls&#09;Trojaned! Hide files.<br/>
crontab&#09;Trojaned! Hidden Crontab Entries.<br/>
ifconfig&#09;Hides the PROMISC flag in its normal output (Useful if the attacker sets up a network sniffer).<br/>
netstat&#09;Trojaned! Hide connections.<br/>
tcpd&#09;Trojaned! Hide connections, avoid denies.<br/>
top, ps, pidof&#09;Trojaned! Hide processes.<br/>
syslogd&#09;Trojaned! Hide logs.<br/>
killall&#09;Trojaned! Wont kill hidden processes.<br/>
bindshell&#09;Port/shell type daemon!<br/>
chfn, chsh, passwd&#09;Trojaned! User-&gt;r00t.<br/>
inetd, login, rshd, sshd&#09;Trojaned! Remote access.<br/>
ADMSniff&#09;Network sniffer.<br/>
fix&#09;Changes timestamp and checksum information on files.<br/>
wted&#09;wtmp/ utmp editor!<br/>
fix&#09;File fixer!<br/>
z2&#09;(Zap 2) utmp/ wtmp/ lastlog eraser!<br/>
# ./configure<br/>
# make all install (for standard install)<br/>
or<br/>
# make shadow install (if the computer uses shadow passwords)<br/>
<br/>
Now the rootkit is installed you will need to modify 4 files:<br/>
<br/>
/dev/ptyq - this sets network connections that should be ignored, based on incoming and outgoing addresses, uid or ports.<br/>
/dev/ptyr - this sets file or directory names to be ignored.<br/>
/dev/ptyp - this sets what processes to ignore, based on uid, tty, or command-line matches.<br/>
/dev/ptys - this sets what syslog entries to ignore, based on pattern matches.<br/>
Now the rootkit is setup! I would recommend having a read through the README file provided with LRK first before you attempt to use this rootkit!<br/>
<br/>
************<br/>
Countermeasures:<br/>
1) Make sure you run some type of file integrity checker! This will spot any trojaned binaries and modified files.<br/>
2) Make a rootkit recovery cd or floppy, on the disk you should include: ls, netstat, ps, top, ifconfig, find, killall, strace, strings, lsof, grep, mount, diff, chkwtmp, and any other programs you may regularly use that might be replaced be a hacker, or that might give you information on the attack.<br/>
3) Log as much as you can, allow extra logging in /etc/login.defs, use swatch to monitor logs, use snort or some other form of IDS to try to catch these attackers early. <br/>
************</body></html>