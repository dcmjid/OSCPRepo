<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Node - NodeJS REST Mongo BO Wildcard Com Inj</title>
</head><body>Useful getting all js links: <br/>
wget -nd -rH -A js --spider domain/page 2&gt;&amp;1 | grep '^--.*\.js' | awk '{print $3}'<br/>
<br/>
can use fcrackzip for password protected ZIP files<br/>
Another possibility is a utility like zip2john or other<br/>
<br/>
mongo CLI:<br/>
mongo -p -u mark &lt;db&gt;<br/>
db.&lt;table&gt;.insert&#09;&#09;&#09;#insert<br/>
<br/>
If you SUID a dash/bash/sh binary, you may also need to invoke it with -p. See below from the ksh man page:<br/>
A shell is privileged if the -p option is used or <b>if the real user-id or group-id does not match the effective user-id or group-id</b>&nbsp;(see getuid(2), getgid(2)). A privileged shell does not process $HOME/.profile nor the ENV parameter (see below), instead the file /etc/suid_profile is processed. Clearing the privileged option causes the shell to set its effective user-id (group-id) to its real user-id (group-id).<br/>
<br/>
radare2 again:<br/>
see cheatsheets<br/>
<br/>
strace<br/>
strace &lt;binary&gt; and look at what it's calling/crashing (without the granularity of a debugger, but still very useful)<br/>
<br/>
Another super fun way to bypass direct blacklist filtering is to use question marks. Most linux distributions will evaluate <br/>
/root <br/>
and<br/>
/r??t<br/>
<br/>
both as valid forms of /root. In this case, /r??t/roo?.txt can get the fllag, but the idea of bypassing using question marks remains the same<br/>
<br/>
Symlinks are fun as well, whether on directories or files :)<br/>
<br/>
Good to read: nrpe cve command injection <br/>
CMD injection using newline characters<br/>
<br/>
example: backup requires 3 parameters, the 3rd param of backup is being passed into this command: zip -r -p magicword %s %s &gt; /dev/null. With bash newline breaks, we can pass <br/>
"junk <br/>
&gt; /bin/bash<br/>
&gt; junk"<br/>
<br/>
and it will drop us into a shell<br/>
<br/>
The third junk param is required to send junk &gt; /dev/null instead of the output of /bin/bash. <br/>
<br/>
<img src="image.png" /><br/>
<br/>
another way is to use printf to insert your newlines<br/>
<img src="image 2.png" /><br/>
<br/>
<br/>
Used the ASLR brute ret2libc template from October, in Useful Artifacts below<br/>
<br/>
</body></html>